# Cursor Rules - Genel Proje KurallarÄ±

## ğŸ—ï¸ Mimari ve YapÄ± KurallarÄ±

### Clean Architecture
- **Domain Layer**: Ä°ÅŸ mantÄ±ÄŸÄ± ve entity'ler
- **Application Layer**: Use case'ler, DTO'lar, interface'ler
- **Infrastructure Layer**: VeritabanÄ±, external service'ler
- **API Layer**: Controller'lar ve endpoint'ler
- **Web/Admin Layer**: UI katmanlarÄ±

### Katman BaÄŸÄ±mlÄ±lÄ±klarÄ±
- Domain â†’ HiÃ§bir katmana baÄŸÄ±mlÄ± deÄŸil
- Application â†’ Sadece Domain'e baÄŸÄ±mlÄ±
- Infrastructure â†’ Domain ve Application'a baÄŸÄ±mlÄ±
- API/Web/Admin â†’ Application ve Infrastructure'a baÄŸÄ±mlÄ±

### CQRS Pattern
- **Commands**: Veri deÄŸiÅŸtiren iÅŸlemler (Create, Update, Delete)
- **Queries**: Veri okuma iÅŸlemleri (Get, List, Search)
- **MediatR**: Command/Query handler'larÄ± iÃ§in kullan

## ğŸ“ Dosya ve KlasÃ¶r YapÄ±sÄ±

### Application Layer
```
src/Application/
â”œâ”€â”€ [EntityName]/
â”‚   â”œâ”€â”€ Commands/
â”‚   â”‚   â”œâ”€â”€ Create[Entity]/
â”‚   â”‚   â”‚   â”œâ”€â”€ Create[Entity]Command.cs
â”‚   â”‚   â”‚   â””â”€â”€ Create[Entity]CommandHandler.cs
â”‚   â”‚   â”œâ”€â”€ Update[Entity]/
â”‚   â”‚   â”‚   â”œâ”€â”€ Update[Entity]Command.cs
â”‚   â”‚   â”‚   â””â”€â”€ Update[Entity]CommandHandler.cs
â”‚   â”‚   â””â”€â”€ Delete[Entity]/
â”‚   â”‚       â”œâ”€â”€ Delete[Entity]Command.cs
â”‚   â”‚       â””â”€â”€ Delete[Entity]CommandHandler.cs
â”‚   â”œâ”€â”€ Queries/
â”‚   â”‚   â”œâ”€â”€ Get[Entity]s/
â”‚   â”‚   â”‚   â”œâ”€â”€ Get[Entity]sQuery.cs
â”‚   â”‚   â”‚   â””â”€â”€ Get[Entity]sQueryHandler.cs
â”‚   â”‚   â””â”€â”€ Get[Entity]ById/
â”‚   â”‚       â”œâ”€â”€ Get[Entity]ByIdQuery.cs
â”‚   â”‚       â””â”€â”€ Get[Entity]ByIdQueryHandler.cs
â”‚   â””â”€â”€ DTOs/
â”‚       â””â”€â”€ [Entity]Dto.cs
â”œâ”€â”€ Common/
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ ApiResponse.cs
â”‚   â”‚   â””â”€â”€ PaginatedApiResponse.cs
â”‚   â””â”€â”€ Interfaces/
â”‚       â””â”€â”€ ICurrentUserService.cs
â”œâ”€â”€ Interfaces/
â”‚   â””â”€â”€ I[Entity]Repository.cs
â”œâ”€â”€ Mappings/
â”‚   â””â”€â”€ [Entity]MappingProfile.cs
â””â”€â”€ Validators/
    â””â”€â”€ [Entity]Validators/
```

### Infrastructure Layer
```
src/Infrastructure/
â”œâ”€â”€ Repositories/
â”‚   â””â”€â”€ [Entity]Repository.cs
â”œâ”€â”€ Data/
â”‚   â”œâ”€â”€ [ProjectName]DbContext.cs
â”‚   â””â”€â”€ Configurations/
â”œâ”€â”€ SeedData/
â”‚   â””â”€â”€ SeedDataService.cs
â””â”€â”€ Services/
    â””â”€â”€ CurrentUserService.cs
```

### API Layer
```
src/API/
â”œâ”€â”€ Controllers/
â”‚   â””â”€â”€ [Entity]sController.cs
â”œâ”€â”€ Middleware/
â”‚   â”œâ”€â”€ GlobalExceptionHandler.cs
â”‚   â””â”€â”€ MaintenanceModeMiddleware.cs
â””â”€â”€ Program.cs
```

## ğŸ”§ Teknoloji Stack'i

### Backend
- **Framework**: ASP.NET Core 8
- **ORM**: Entity Framework Core
- **Database**: Microsoft SQL Server (MSSQL)
- **Authentication**: Microsoft.AspNetCore.Identity
- **Caching**: IMemoryCache / IDistributedCache
- **Logging**: Serilog veya ILogger
- **Validation**: FluentValidation
- **Mapping**: AutoMapper
- **Migration**: FluentMigrator
- **Fake Data**: Bogus

### Maggsoft Framework
- **Maggsoft.Core**: Temel utility'ler ve extension'lar
- **Maggsoft.Mssql**: MSSQL entegrasyonu ve repository pattern
- **Maggsoft.Cache**: Caching mekanizmalarÄ±
- **Maggsoft.Logging**: Logging sistemi
- **Maggsoft.Api**: API endpoint'leri ve response wrapper'larÄ±
- **Maggsoft.Identity**: Identity entegrasyonu
- **Maggsoft.Validation**: Validation framework'Ã¼
- **Maggsoft.Mapping**: Object mapping utilities

### Frontend
- **Framework**: Bootstrap 5 (sadece)
- **Approach**: Mobile-first, responsive
- **No**: TailwindCSS, custom CSS (mÃ¼mkÃ¼n olduÄŸunca)

## ğŸ“ Kod YazÄ±m KurallarÄ±

### Naming Conventions
- **PascalCase**: Class, Method, Property
- **camelCase**: Local variables, parameters
- **UPPER_CASE**: Constants
- **PascalCase**: File names (C#)
- **kebab-case**: File names (HTML, CSS, JS)

### Repository Pattern
```csharp
public interface I[Entity]Repository
{
    // READ
    Task<IEnumerable<[Entity]>> GetAllAsync();
    Task<[Entity]?> GetByIdAsync(Guid id);
    
    // WRITE
    Task<[Entity]> AddAsync([Entity] entity);
    Task<[Entity]> UpdateAsync([Entity] entity);
    Task DeleteAsync(Guid id);
    Task<int> SaveChangesAsync();
}
```

### Command/Query Pattern
```csharp
// Command
public class Create[Entity]Command : IRequest<ApiResponse<Guid>>
{
    // Properties
}

public class Create[Entity]CommandHandler : IRequestHandler<Create[Entity]Command, ApiResponse<Guid>>
{
    public async Task<ApiResponse<Guid>> Handle(Create[Entity]Command request, CancellationToken cancellationToken)
    {
        // Implementation
    }
}

// Query
public class Get[Entity]sQuery : IRequest<PaginatedApiResponse<[Entity]Dto>>
{
    // Properties
}
```

### API Response Pattern
```csharp
public class ApiResponse<T>
{
    public bool Success { get; set; }
    public string Message { get; set; } = string.Empty;
    public T? Data { get; set; }
    public List<string> Errors { get; set; } = new();
}

public class PaginatedApiResponse<T> : ApiResponse<List<T>>
{
    public int PageNumber { get; set; }
    public int PageSize { get; set; }
    public int TotalCount { get; set; }
    public int TotalPages { get; set; }
}
```

## ğŸ¯ Ä°ÅŸ MantÄ±ÄŸÄ± KurallarÄ±

### Validation
- **FluentValidation**: TÃ¼m Command'ler iÃ§in validator oluÅŸtur
- **Business Rules**: Handler'larda iÅŸ kurallarÄ±nÄ± kontrol et
- **Null Checks**: Null reference exception'larÄ± Ã¶nle

### Error Handling
- **Global Exception Handler**: TÃ¼m exception'larÄ± yakala
- **Meaningful Messages**: KullanÄ±cÄ± dostu hata mesajlarÄ±
- **Logging**: TÃ¼m hatalarÄ± logla

### Security
- **Authentication**: Identity kullan
- **Authorization**: Role-based access control
- **Input Validation**: TÃ¼m input'larÄ± validate et
- **SQL Injection**: Parameterized queries kullan

## ğŸŒ API Design Rules

### RESTful Endpoints
```
GET    /api/[entity]s          # List
GET    /api/[entity]s/{id}     # Get by ID
POST   /api/[entity]s          # Create
PUT    /api/[entity]s/{id}     # Update
DELETE /api/[entity]s/{id}     # Delete
```

### HTTP Status Codes
- **200**: Success
- **201**: Created
- **400**: Bad Request
- **401**: Unauthorized
- **403**: Forbidden
- **404**: Not Found
- **500**: Internal Server Error

### Response Format
```json
{
  "success": true,
  "message": "Ä°ÅŸlem baÅŸarÄ±lÄ±",
  "data": {},
  "errors": []
}
```

## ğŸ”„ Development Workflow

### SÄ±ralÄ± GeliÅŸtirme
1. **Domain**: Entity'leri oluÅŸtur
2. **Application**: Interface'leri, DTO'larÄ±, Command/Query'leri oluÅŸtur
3. **Infrastructure**: Repository'leri implement et
4. **API**: Controller'larÄ± oluÅŸtur
5. **Web/Admin**: UI'larÄ± geliÅŸtir

### Repository Implementation
- **IMssqlRepository**: Kullanma (circular dependency)
- **Composition**: Repository<T> kullanma
- **SaveChanges**: Handler'larda explicit Ã§aÄŸÄ±r
- **Async/Await**: TÃ¼m database iÅŸlemleri async

### Maggsoft Framework KullanÄ±mÄ±
- **Maggsoft.Mssql.Repository**: Sealed class olduÄŸu iÃ§in inheritance kullanma
- **Maggsoft.Mssql.IMssqlRepository**: Interface inheritance yapma (circular dependency)
- **Maggsoft.Api.Response**: ApiResponse<T> yerine kendi ApiResponse'umuzu kullan
- **Maggsoft.Cache**: Distributed cache iÃ§in kullan
- **Maggsoft.Logging**: Structured logging iÃ§in kullan
- **Maggsoft.Validation**: FluentValidation ile entegre et
- **Maggsoft.Mapping**: AutoMapper ile entegre et
- **Maggsoft.Mssql.Services**
- **dotnet add package Maggsoft.Core --version 2.0.39
- **dotnet add package Maggsoft.Data --version 2.0.20
- **dotnet add package Maggsoft.Framework --version 2.3.6
- **dotnet add package Maggsoft.Data.Mssql --version 2.0.10
- **dotnet add package Maggsoft.Mssql --version 2.0.12
- **dotnet add package Maggsoft.Cache --version 2.0.22
- **dotnet add package Maggsoft.Cache.MemoryCache --version 2.0.7
- **dotnet add package Maggsoft.Services --version 2.0.8
- **dotnet add package Maggsoft.Aspect.Core --version 1.0.15
- **dotnet add package Maggsoft.Mssql.Services --version 2.0.17
- **dotnet add package Maggsoft.Endpoints --version 2.0.7
- **dotnet add package Maggsoft.Sqlite --version 2.0.8
- **dotnet add package Maggsoft.Data.Sqlite --version 2.0.12
- **dotnet add package Maggsoft.Sqlite.Services --version 2.0.10
- **dotnet add package Maggsoft.Ocelot.Core --version 1.0.6
- **dotnet add package Maggsoft.Data.Npgsql --version 1.0.11
- **dotnet add package Maggsoft.Cache.Redis --version 2.0.3
- **dotnet add package Maggsoft.Data.Mongo --version 1.0.3
- **dotnet add package Maggsoft.EventBus.IoC --version 1.0.16
- **dotnet add package Maggsoft.EventBus.RabbitMQ --version 1.0.17
- **dotnet add package Maggsoft.EventBus.AzureServiceBus --version 1.0.15
- **dotnet add package Maggsoft.Dto.Sqlite --version 2.0.2
- **dotnet add package Maggsoft.Dto.Mongo --version 1.0.2
- **dotnet add package Maggsoft.Dto.Npgsql --version 1.0.2,
- **dotnet add package Maggsoft.Mongo.Services --version 1.0.8
- **dotnet add package Maggsoft.Dto.Mssql --version 1.0.2
- **dotnet add package Maggsoft.Npgsql.Services --version 1.0.8
- **dotnet add package Maggsoft.EventBus --version 1.0.19
- **dotnet add package Maggsoft.Npgsql --version 1.0.5
- **dotnet add package Maggsoft.Logging --version 1.0.6
- **dotnet add package Maggsoft.Mongo --version 1.0.5

### Seed Data
- **Admin User**: admin@gmail.com / Super123!
- **Bogus**: Fake data generation
- **Migration**: FluentMigrator ile

## ğŸ“š Documentation

### Code Comments
- **Turkish**: TÃ¼m yorumlar TÃ¼rkÃ§e
- **XML Documentation**: Public method'lar iÃ§in
- **README**: Proje aÃ§Ä±klamasÄ±

### Swagger
- **API Documentation**: Swagger/OpenAPI
- **Versioning**: API versioning
- **Examples**: Request/Response Ã¶rnekleri

## ğŸš€ Performance Rules

### Caching
- **Memory Cache**: SÄ±k kullanÄ±lan veriler
- **Distributed Cache**: Multi-instance deployment
- **Cache Keys**: AnlamlÄ± cache key'leri

### Database
- **Indexes**: Performans iÃ§in index'ler
- **Pagination**: BÃ¼yÃ¼k listeler iÃ§in
- **Lazy Loading**: Navigation property'ler iÃ§in

## ğŸ”§ Configuration

### App Settings
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "..."
  },
  "JwtSettings": {
    "SecretKey": "...",
    "Issuer": "...",
    "Audience": "..."
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information"
    }
  }
}
```

### Dependency Injection
```csharp
// Application
services.AddMediatR(cfg => cfg.RegisterServicesFromAssembly(typeof(Program).Assembly));
services.AddAutoMapper(typeof(Program).Assembly);
services.AddFluentValidationAutoValidation();

// Infrastructure
services.AddDbContext<[ProjectName]DbContext>();
services.AddIdentity<[User], [Role]>();
services.AddScoped<I[Entity]Repository, [Entity]Repository>();
```

## ğŸ¨ UI/UX Rules

### Bootstrap 5
- **Components**: Navbar, Cards, Buttons, Modals, Forms, Tables
- **Utilities**: Spacing, Colors, Typography
- **Grid System**: Responsive layout
- **No Custom CSS**: MÃ¼mkÃ¼n olduÄŸunca utility class'larÄ± kullan

### Accessibility
- **Semantic HTML**: DoÄŸru HTML element'leri
- **Alt Text**: TÃ¼m resimler iÃ§in
- **Form Labels**: TÃ¼m form kontrol'leri iÃ§in
- **ARIA**: Gerekli yerlerde ARIA attribute'larÄ±

## ğŸ” Code Quality

### Best Practices
- **SOLID Principles**: Single Responsibility, Open/Closed, etc.
- **DRY**: Don't Repeat Yourself
- **KISS**: Keep It Simple, Stupid
- **YAGNI**: You Aren't Gonna Need It

### Code Review Checklist
- [ ] Naming conventions
- [ ] Error handling
- [ ] Validation
- [ ] Security
- [ ] Performance
- [ ] Documentation

## ğŸš¨ Anti-Patterns (Yapma!)

### âŒ YapÄ±lmayacaklar
- Business logic'i controller'lara yazma
- Repository'lerde SaveChanges Ã§aÄŸÄ±rma
- Hard-coded connection string'ler
- Exception'larÄ± yakalamadan bÄ±rakma
- Null reference exception'lara izin verme
- Circular dependency oluÅŸturma
- IMssqlRepository inheritance kullanma
- Maggsoft.Mssql.Repository'den inheritance yapma (sealed class)
- Maggsoft.Api.Response kullanma (kendi ApiResponse'umuzu kullan)
- Maggsoft framework'Ã¼ olmadan proje baÅŸlatma

### âœ… YapÄ±lacaklar
- Clean Architecture'a uy
- CQRS pattern kullan
- Proper error handling
- Comprehensive validation
- Documentation ekle
- Security best practices uygula

## ğŸ“‹ Checklist Template

### Yeni Entity Ekleme
- [ ] Domain Entity oluÅŸtur
- [ ] Application Interface oluÅŸtur
- [ ] DTO'larÄ± oluÅŸtur
- [ ] Command/Query'leri oluÅŸtur
- [ ] Handler'larÄ± implement et
- [ ] Repository implement et
- [ ] Controller oluÅŸtur
- [ ] Validator'larÄ± yaz
- [ ] Mapping profile oluÅŸtur
- [ ] Seed data ekle

### Yeni Feature Ekleme
- [ ] Requirements analiz et
- [ ] Domain model'i gÃ¼ncelle
- [ ] Application layer'Ä± gÃ¼ncelle
- [ ] Infrastructure layer'Ä± gÃ¼ncelle
- [ ] API endpoint'lerini ekle
- [ ] UI'Ä± gÃ¼ncelle
- [ ] Documentation gÃ¼ncelle

Bu kurallar tÃ¼m projelerinizde tutarlÄ±lÄ±k saÄŸlayacak ve Clean Architecture prensiplerine uygun geliÅŸtirme yapmanÄ±za yardÄ±mcÄ± olacaktÄ±r. 